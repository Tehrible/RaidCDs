function ()    
    
    local parentName = WeakAurasSaved.displays[WeakAuras.regions[aura_env.id].region:GetParent().id]
    if (parentName["TehrsRaidCDs"] == nil) then parentName["TehrsRaidCDs"] = {} end    
    if (parentName["TehrsRaidCDs"]["Show Settings"] == nil) then parentName["TehrsRaidCDs"]["Show Settings"] = {} end
    if (parentName["TehrsRaidCDs"]["Translation Settings"] == nil) then parentName["TehrsRaidCDs"]["Translation Settings"] = {} end    
    if (parentName["TehrsRaidCDs"]["Translation Settings"]["frFR"] == nil) then parentName["TehrsRaidCDs"]["Translation Settings"]["frFR"] = {} end
    if (parentName["TehrsRaidCDs"]["Translation Settings"]["zhCN"] == nil) then parentName["TehrsRaidCDs"]["Translation Settings"]["zhCN"] = {} end
    if (parentName["TehrsRaidCDs"]["Translation Settings"]["zhTW"] == nil) then parentName["TehrsRaidCDs"]["Translation Settings"]["zhTW"] = {} end
    if (parentName["TehrsRaidCDs"]["Translation Settings"]["deDE"] == nil) then parentName["TehrsRaidCDs"]["Translation Settings"]["deDE"] = {} end
    if (parentName["TehrsRaidCDs"]["Translation Settings"]["ruRU"] == nil) then parentName["TehrsRaidCDs"]["Translation Settings"]["ruRU"] = {} end
    if (parentName["TehrsRaidCDs"]["Translation Settings"]["koKR"] == nil) then parentName["TehrsRaidCDs"]["Translation Settings"]["koKR"] = {} end
    if (parentName["TehrsRaidCDs"]["Translation Settings"]["esES"] == nil) then parentName["TehrsRaidCDs"]["Translation Settings"]["esES"] = {} end
    if (parentName["TehrsRaidCDs"]["Translation Settings"]["itIT"] == nil) then parentName["TehrsRaidCDs"]["Translation Settings"]["itIT"] = {} end
    local TehrsCDs = parentName["TehrsRaidCDs"]        
    
    local nameMaxLength = 8
    local locale = GetLocale()
    local titles = { }
    local abilityNames
    
    if (TehrsCDs._raidCDs_textPoll == nil) then TehrsCDs._raidCDs_textPoll = GetTime() end
    if (TehrsCDs._raidCDs_namesText == nil) then TehrsCDs._raidCDs_namesText = "" end
    aura_env.Supporters = aura_env.Supporters or { }
    
    if (GetTime() - TehrsCDs._raidCDs_textPoll < 0.5) then
        return TehrsCDs._raidCDs_namesText;
    else
        TehrsCDs._raidCDs_textPoll = GetTime();
    end
    
    local backgroundName = WeakAurasSaved.displays[WeakAuras.regions[aura_env.id].region:GetParent().id]["controlledChildren"][6]    
    local fontSize = WeakAurasSaved.displays[aura_env.id]["fontSize"]
    
    _, TehrsCDs.instanceType = IsInInstance();
    _, TehrsCDs.instanceGroupType, TehrsCDs.instanceDifficulty = GetInstanceInfo();
    
    TehrsCDs._raidCDs_namesText = "                                                          ";
    TehrsCDs._raidCDs_cdText = "                                                             ";
    TehrsCDs._raidCDs_timeText = "                                                             ";
    
    if locale == "ruRU" then nameMaxLength = 16
    elseif locale == "zhCN" then nameMaxLength = 18
    elseif locale == "zhTW" then nameMaxLength = 18    end  
    
    if TehrsCDs["Translation Settings"]["frFR"].Translation_French then
        titles = TehrsCDs["Translation Settings"]["frFR"].Translation_French_titles
        abilityNames = TehrsCDs["Translation Settings"]["frFR"].Translation_French_abilityNames
    elseif TehrsCDs["Translation Settings"]["zhCN"].Translation_Chinese then
        titles = TehrsCDs["Translation Settings"]["zhCN"].Translation_Chinese_titles
        abilityNames = TehrsCDs["Translation Settings"]["zhCN"].Translation_Chinese_abilityNames
    elseif TehrsCDs["Translation Settings"]["zhTW"].Translation_ChineseTraditional then
        titles = TehrsCDs["Translation Settings"]["zhTW"].Translation_ChineseTraditional_titles
        abilityNames = TehrsCDs["Translation Settings"]["zhTW"].Translation_ChineseTraditional_abilityNames        
    elseif TehrsCDs["Translation Settings"]["deDE"].Translation_German then
        titles = TehrsCDs["Translation Settings"]["deDE"].Translation_German_titles 
        abilityNames = TehrsCDs["Translation Settings"]["deDE"].Translation_German_abilityNames
    elseif TehrsCDs["Translation Settings"]["koKR"].Translation_Korean then
        titles = TehrsCDs["Translation Settings"]["koKR"].Translation_Korean_titles
        abilityNames = TehrsCDs["Translation Settings"]["koKR"].Translation_Korean_abilityNames
    elseif TehrsCDs["Translation Settings"]["ruRU"].Translation_Russian then
        titles = TehrsCDs["Translation Settings"]["ruRU"].Translation_Russian_titles
        abilityNames = TehrsCDs["Translation Settings"]["ruRU"].Translation_Russian_abilityNames        
    elseif TehrsCDs["Translation Settings"]["esES"].Translation_Spanish then
        titles = TehrsCDs["Translation Settings"]["esES"].Translation_Spanish_titles
        abilityNames = TehrsCDs["Translation Settings"]["esES"].Translation_Spanish_abilityNames    
    elseif TehrsCDs["Translation Settings"]["esES"].Translation_Spanish then
        titles = TehrsCDs["Translation Settings"]["esES"].Translation_Spanish_titles
        abilityNames = TehrsCDs["Translation Settings"]["esES"].Translation_Spanish_abilityNames        
    elseif TehrsCDs["Translation Settings"]["itIT"].Translation_Italian then
        titles = TehrsCDs["Translation Settings"]["itIT"].Translation_Italian_titles
        abilityNames = TehrsCDs["Translation Settings"]["itIT"].Translation_Italian_abilityNames            
    else
        titles[1],titles[2],titles[3],titles[4],titles[5],titles[6],titles[7],titles[8] =
        "Externals","Raid CDs","Utility CDs","Immunities","Crowd Control","Interrupts","Battle Rezzes","Battle Rez Counter"    
    end 
    
    if WeakAuras.IsOptionsOpen() then
        if (GetNumGroupMembers() > 0) or TehrsCDs["Show Settings"].WhenSolo then
            TehrsCDs._raidCDs_namesText =  TehrsCDs._raidCDs_namesText.."\nRELOAD YOUR UI AFTER CHANGING ANY SETTINGS\n|cFF00A2E8Made by Tehrdk of Illidan (US)                        |r"
            TehrsCDs._raidCDs_cdText = TehrsCDs._raidCDs_cdText.."\n\n"
            TehrsCDs._raidCDs_timeText = TehrsCDs._raidCDs_timeText.."\n\n"
        else
            if aura_env.AprilFools and date("%m") == "04" and (date("%d") == "01" or date("%d") == "02") then
                TehrsCDs._raidCDs_namesText =  TehrsCDs._raidCDs_namesText.."\n\n|cFF00A2E8Kellogg's Eggo Waffles                        |r\n"..aura_env.raidCDsIndentAmount.."|cFFF04A23Homestyle|r\n"..aura_env.raidCDsIndentAmount.."|cFF00B5BFButtermilk|r\n"..aura_env.raidCDsIndentAmount.."|cFF5F271EChocolate|r\n".."\n|cFF00A2E8Thick & Fluffy                        |r\n\n"..aura_env.raidCDsIndentAmount.."|cFF0087ACOriginal|r\n"..aura_env.raidCDsIndentAmount.."|cFF9F543ACinnamon|r\n"..aura_env.raidCDsIndentAmount.."|cFF4E3B7FCobbler|r\n"..aura_env.raidCDsIndentAmount.."|cFFC92031Shortcake|r\n".."\n|cFF00A2E8Fruity                        |r\n\n"..aura_env.raidCDsIndentAmount.."|cFF2E3891Blueberry|r\n"..aura_env.raidCDsIndentAmount.."|cFFC62550Strawberry|r\n"
                TehrsCDs._raidCDs_cdText = TehrsCDs._raidCDs_cdText.."\n\n\n|cFFF04A23Crispy|r\n|cFF00B5BFDelicious|r\n|cFF5F271EYummy|r\n\n\n\n|cFF0087ACDelightful|r\n|cFF9F543ASweet|r\n|cFF4E3B7FTasty|r\n|cFFC92031Exquisite|r\n\n\n\n|cFF2E3891Berry Good|r\n|cFFC62550Mmmmm...|r\n";
                TehrsCDs._raidCDs_timeText = TehrsCDs._raidCDs_timeText.."\n\n\n|cFFFF000001:59|r\n|cFF00FF00READY|r\n|cFFFF660000:59|r\n\n\n\n|cFFFFCC0000:09|r\n|cFF00FF00READY|r\n|cFFFF000001:59|r\n|cFF333333READY|r\n\n\n\n|cFFFF660000:59|r\n|cFF333333READY|r\n"; 
            else
                TehrsCDs._raidCDs_namesText =  TehrsCDs._raidCDs_namesText.."\n|cFF00A2E8Made by Tehr                        |r\n\n"..aura_env.raidCDsIndentAmount.."|cFFC41F3BTehr (US)|r\n".."\n|cFF00A2E8Battle.net                        |r\n\n"..aura_env.raidCDsIndentAmount.."|cFFFF7D0ATehr|r\n".."\n|cFF00A2E8Discord                        |r\n\n"..aura_env.raidCDsIndentAmount.."|cFFC79C6ETehr|r\n".."\n|cFF00A2E8Stream                        |r\n\n"..aura_env.raidCDsIndentAmount.."|cFFF58CBAtwitch.tv/tehrible|r\n".."\n|cFF00A2E8Patreon                        |r\n\n"..aura_env.raidCDsIndentAmount.."|cFFA330C9patreon.com/RaidCDs|r\n".."\n|cFF00A2E8PayPal                        |r\n\n"..aura_env.raidCDsIndentAmount.."|cFFFFFFFFtehrible@gmail.com|r\n".."\n|cFF00A2E8Latest updates available from:                        |r\n\n"..aura_env.raidCDsIndentAmount.."|cFF00FF96wago.io/RaidCDs|r\n" 
                TehrsCDs._raidCDs_cdText = TehrsCDs._raidCDs_cdText.."\n\n\n|cFFC41F3BSargeras|r\n\n\n\n|cFFFF7D0A#1477|r\n\n\n\n|cFFC79C6E#5246|r\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n";
                TehrsCDs._raidCDs_timeText = TehrsCDs._raidCDs_timeText.."\n\n\n|cFF00FF00READY|r\n\n\n\n|cFFFFCC0000:09|r\n\n\n\n|cFFFF660000:59|r\n\n\n\n|cFFFF000001:59|r\n\n\n\n|cFFFF000029:59|r\n\n\n\n|cFFFF660059|r\n\n\n\n|cFF333333READY|r\n"; 
            end
        end
    end
    
    if (GetNumGroupMembers() > 0) or TehrsCDs["Show Settings"].WhenSolo then
        
        --[[
        TehrsCDs._raidCDs_namesText =  "\n"..TehrsCDs._raidCDs_namesText.."\n                                 \n";
        TehrsCDs._raidCDs_cdText = "\n"..TehrsCDs._raidCDs_cdText.."\n\n";
        TehrsCDs._raidCDs_timeText = "\n"..TehrsCDs._raidCDs_timeText.."\n\n";         
        ]]
        
        if (TehrsCDs["Show Settings"].allExterns and TehrsCDs.instanceType ~= "raid" and GetNumGroupMembers()<20) or (TehrsCDs["Show Settings"].allExterns_inRaid and (TehrsCDs.instanceType == "raid" or GetNumGroupMembers()>19)) then         

            local cdCount = 0;
            local cdTexts = { }; 
            local allExterns = { };
            
            allExterns["|cFFFF7D0A"] = TehrsCDs._externCDs_druids;
            allExterns["|cFF00FF96"] = TehrsCDs._externCDs_monks;
            allExterns["|cFFF58CBA"] = TehrsCDs._externCDs_paladins;
            allExterns["|cFFFFFFFF"] = TehrsCDs._externCDs_priests;    
            allExterns["|cFFC79C6E"] = TehrsCDs._externCDs_warriors;
            allExterns["|cFFA330C9"] = TehrsCDs._externCDs_dhs;   
            
            for theCDGroupColor, theCDGroup in pairs(allExterns) do
                if (theCDGroup ~= nil) then        
                    for name, cdData in pairs(theCDGroup) do             
                        for cdName, cdTime in aura_env.sortedPairs(cdData) do 
                            
                            if not ((not TehrsCDs["Show Settings"].Safeguard and cdName == "Safeguard")
                                or (not TehrsCDs["Show Settings"].GSpirit and cdName == "G-Spirit")
                                or (not TehrsCDs["Show Settings"].GSpirit and cdName == "G-Spirit+")
                                or (not TehrsCDs["Show Settings"].PSup and cdName == "P-Sup")                                
                                or (not TehrsCDs["Show Settings"].PSup and cdName == "P-Sup+")
                                or (not TehrsCDs["Show Settings"].IBark and cdName == "I-Bark")
                                or (not TehrsCDs["Show Settings"].IBark and cdName == "I-Bark+")
                                or (not TehrsCDs["Show Settings"].Spellward and cdName == "Spellward")
                                or (not TehrsCDs["Show Settings"].Sac and cdName == "Sac")
                                or (not TehrsCDs["Show Settings"].BoP and cdName == "BoP")
                                or (not TehrsCDs["Show Settings"].LoH and cdName == "LoH")
                                or (not TehrsCDs["Show Settings"].LoH and cdName == "LoH+")
                                or (not TehrsCDs["Show Settings"].LCocoon and cdName == "L-Cocoon")) then
                                
                                local timeColor;
                                local nameColor;
                                local cdDTime = cdTime - GetTime();  
                                local unitName = UnitName(name)                            
                                local unitRealm = GetRealmName(name)
                                
                                if aura_env.recolor then
                                    if (UnitHealth(name) <= 0 or UnitIsGhost(name)) then
                                        nameColor = aura_env.deadColor
                                        timeColor = aura_env.deadColor
                                    elseif not IsItemInRange(34471,name) and -- 40 Yards
                                        (cdName == "G-Spirit" or cdName == "G-Spirit+" or cdName == "LoH" or cdName == "LoH+" or cdName == "BoP" or cdName == "L-Cocoon" or cdName == "P-Sup" or cdName == "P-Sup+" or cdName == "I-Bark" or cdName == "I-Bark+" or cdName == "Spellward" or cdName == "Sac") then
                                        nameColor = aura_env.outOfRangeColor
                                        timeColor = aura_env.outOfRangeColor        
                                    elseif not IsItemInRange(31463,name) and -- 25 Yards
                                        (cdName == "Safeguard") then
                                        nameColor = aura_env.outOfRangeColor
                                        timeColor = aura_env.outOfRangeColor                                        
                                    else    
                                        nameColor = theCDGroupColor
                                        timeColor = aura_env.colorByTime(cdDTime)
                                    end      
                                else    
                                    nameColor = theCDGroupColor
                                    timeColor = aura_env.colorByTime(cdDTime)                   
                                end    
                                
                                if (cdDTime <= 0) then
                                    cdDTime = timeColor.."READY|r";
                                else
                                    cdDTime = timeColor..string.format("%01d:%02d", math.floor(cdDTime/60), math.floor(cdDTime - 60*math.floor(cdDTime/60))).."|r"
                                end            
                                
                                dashpos = string.find(name,"-");
                                if (dashpos ~= nil) then name = string.sub(name, 0, dashpos - 1) end
                                
                                newName = string.sub(name, 0, nameMaxLength);
                                
                                if (string.len(newName) <  string.len(name)) then newName = newName..".." end
                                
                                for k,v in pairs(aura_env.Supporters) do
                                    if (k == name) and (v == unitRealm) then
                                        newName = "*"..newName
                                    end
                                end
                                
                                if abilityNames ~= nil then
                                    for k,v in pairs(abilityNames) do
                                        if k == cdName then
                                            cdName = v
                                        end    
                                    end    
                                end
                                
                                if newName ~= nil then
                                    if not TehrsCDs["Show Settings"].ShowOnCooldownOnly or (TehrsCDs["Show Settings"].ShowOnCooldownOnly and cdDTime ~= timeColor.."READY|r") then
                                        cdCount = cdCount + 1 
                                        cdTexts[cdCount] = {
                                            aura_env.raidCDsIndentAmount..nameColor..newName,
                                            nameColor..cdName,
                                            cdDTime
                                        }
                                    end
                                end                                
                            end
                        end           
                    end        
                end    
            end
            if TehrsCDs["Show Settings"].ShowEmptySections or #cdTexts > 0 then
                TehrsCDs._raidCDs_namesText =  TehrsCDs._raidCDs_namesText.."\n|cFF00A2E8"..titles[1].."               |r\n\n";
                TehrsCDs._raidCDs_cdText = TehrsCDs._raidCDs_cdText.."\n\n\n";
                TehrsCDs._raidCDs_timeText = TehrsCDs._raidCDs_timeText.."\n\n\n"; 

                if #cdTexts > 0 then 
                    for index, value in pairs(cdTexts) do
                        TehrsCDs._raidCDs_namesText =  TehrsCDs._raidCDs_namesText..value[1].."\n";
                        TehrsCDs._raidCDs_cdText = TehrsCDs._raidCDs_cdText..value[2].."\n";
                        TehrsCDs._raidCDs_timeText = TehrsCDs._raidCDs_timeText..value[3].."\n";  
                    end
                end
            end            
        end   
        
        if (TehrsCDs["Show Settings"].allCDs and TehrsCDs.instanceType ~= "raid" and GetNumGroupMembers()<20) or (TehrsCDs["Show Settings"].allCDs_inRaid and (TehrsCDs.instanceType == "raid" or GetNumGroupMembers()>19)) then  
            
            local cdCount = 0;
            local cdTexts = { }; 
            local allCDs = { };
            
            allCDs["|cFFFF7D0A"] = TehrsCDs._raidCDs_druids;
            allCDs["|cFF00FF96"] = TehrsCDs._raidCDs_monks;
            allCDs["|cFFF58CBA"] = TehrsCDs._raidCDs_paladins;
            allCDs["|cFFFFFFFF"] = TehrsCDs._raidCDs_priests;
            allCDs["|cFF0070DE"] = TehrsCDs._raidCDs_shamans;
            allCDs["|cFFC79C6E"] = TehrsCDs._raidCDs_warriors;
            allCDs["|cFFA330C9"] = TehrsCDs._raidCDs_dhs;              
            
            for theCDGroupColor, theCDGroup in pairs(allCDs) do
                if (theCDGroup ~= nil) then        
                    for name, cdData in pairs(theCDGroup) do             
                        for cdName, cdTime in aura_env.sortedPairs(cdData) do 
                            
                            if not ((not TehrsCDs["Show Settings"].CShout and cdName == "R-Cry")
                                or (not TehrsCDs["Show Settings"].DHymn and cdName == "D-Hymn")
                                or (not TehrsCDs["Show Settings"].VE and cdName == "VE")
                                or (not TehrsCDs["Show Settings"].VE and cdName == "VE+")
                                or (not TehrsCDs["Show Settings"].Apotheosis and cdName == "Apotheosis")
                                or (not TehrsCDs["Show Settings"].Salvation and cdName == "Salvation")                                
                                or (not TehrsCDs["Show Settings"].Barrier and cdName == "Barrier")
                                or (not TehrsCDs["Show Settings"].Barrier and cdName == "Barrier+")
                                or (not TehrsCDs["Show Settings"].Barrier and cdName == "Rapture")
                                or (not TehrsCDs["Show Settings"].Darkness and cdName == "Darkness")
                                or (not TehrsCDs["Show Settings"].Tranq and cdName == "Tranq")
                                or (not TehrsCDs["Show Settings"].Tranq and cdName == "Tranq+")
                                or (not TehrsCDs["Show Settings"].Flourish and cdName == "Flourish")                                
                                or (not TehrsCDs["Show Settings"].AuraM and cdName == "Aura-M")
                                or (not TehrsCDs["Show Settings"].Wings and cdName == "Wings")            
                                or (not TehrsCDs["Show Settings"].Wings and cdName == "Wings+")                                        
                                or (not TehrsCDs["Show Settings"].Aegis and cdName == "Aegis")
                                or (not TehrsCDs["Show Settings"].AProt and cdName == "A-Prot")
                                or (not TehrsCDs["Show Settings"].AG and cdName == "AG")
                                or (not TehrsCDs["Show Settings"].HTide and cdName == "H-Tide")
                                or (not TehrsCDs["Show Settings"].Ascendance and cdName == "Ascendance")
                                or (not TehrsCDs["Show Settings"].SLT and cdName == "SLT")                            
                                or (not TehrsCDs["Show Settings"].Revival and cdName == "Revival")) then
                                
                                local timeColor;
                                local nameColor;
                                local cdDTime = cdTime - GetTime();  
                                local unitName = UnitName(name)                            
                                local unitRealm = GetRealmName(name)                                
                                
                                if aura_env.recolor then
                                    if (UnitHealth(name) <= 0 or UnitIsGhost(name)) then
                                        nameColor = aura_env.deadColor
                                        timeColor = aura_env.deadColor                                        
                                    else    
                                        nameColor = theCDGroupColor
                                        timeColor = aura_env.colorByTime(cdDTime)
                                    end      
                                else    
                                    nameColor = theCDGroupColor
                                    timeColor = aura_env.colorByTime(cdDTime)                   
                                end    
                                
                                if (cdDTime <= 0) then
                                    cdDTime = timeColor.."READY|r";
                                else
                                    cdDTime = timeColor..string.format("%01d:%02d", math.floor(cdDTime/60), math.floor(cdDTime - 60*math.floor(cdDTime/60))).."|r"
                                end            
                                
                                dashpos = string.find(name,"-");
                                if (dashpos ~= nil) then name = string.sub(name, 0, dashpos - 1) end
                                
                                newName = string.sub(name, 0, nameMaxLength);
                                
                                if (string.len(newName) <  string.len(name)) then newName = newName..".." end
                                
                                for k,v in pairs(aura_env.Supporters) do
                                    if (k == name) and (v == unitRealm) then
                                        newName = "*"..newName
                                    end
                                end
                                
                                if abilityNames ~= nil then
                                    for k,v in pairs(abilityNames) do
                                        if k == cdName then
                                            cdName = v
                                        end    
                                    end    
                                end
                                
                                if newName ~= nil then
                                    if not TehrsCDs["Show Settings"].ShowOnCooldownOnly or (TehrsCDs["Show Settings"].ShowOnCooldownOnly and cdDTime ~= timeColor.."READY|r") then
                                        cdCount = cdCount + 1 
                                        cdTexts[cdCount] = {
                                            aura_env.raidCDsIndentAmount..nameColor..newName,
                                            nameColor..cdName,
                                            cdDTime
                                        }
                                    end
                                end                                
                            end
                        end           
                    end        
                end    
            end
            if TehrsCDs["Show Settings"].ShowEmptySections or #cdTexts > 0 then
                TehrsCDs._raidCDs_namesText =  TehrsCDs._raidCDs_namesText.."\n|cFF00A2E8"..titles[2].."               |r\n\n";
                TehrsCDs._raidCDs_cdText = TehrsCDs._raidCDs_cdText.."\n\n\n";
                TehrsCDs._raidCDs_timeText = TehrsCDs._raidCDs_timeText.."\n\n\n"; 

                if #cdTexts > 0 then 
                    for index, value in pairs(cdTexts) do
                        TehrsCDs._raidCDs_namesText =  TehrsCDs._raidCDs_namesText..value[1].."\n";
                        TehrsCDs._raidCDs_cdText = TehrsCDs._raidCDs_cdText..value[2].."\n";
                        TehrsCDs._raidCDs_timeText = TehrsCDs._raidCDs_timeText..value[3].."\n";  
                    end
                end
            end            
        end
        
        if (TehrsCDs["Show Settings"].allUtility and TehrsCDs.instanceType ~= "raid" and GetNumGroupMembers()<20) or (TehrsCDs["Show Settings"].allUtility_inRaid and (TehrsCDs.instanceType == "raid" or GetNumGroupMembers()>19)) then 
            
            local cdCount = 0;
            local cdTexts = { }; 
            local allUtility = { };
            
            allUtility["|cFFC41F3B"] = TehrsCDs._utilityCDs_dks;    
            allUtility["|cFFA330C9"] = TehrsCDs._utilityCDs_dhs;    
            allUtility["|cFFFF7D0A"] = TehrsCDs._utilityCDs_druids;
            allUtility["|cFFF58CBA"] = TehrsCDs._utilityCDs_paladins;
            allUtility["|cFFFFFFFF"] = TehrsCDs._utilityCDs_priests;
            allUtility["|cFF0070DE"] = TehrsCDs._utilityCDs_shamans;  
            allUtility["|cFFABD473"] = TehrsCDs._utilityCDs_hunters;       
            allUtility["|cFFFFF569"] = TehrsCDs._utilityCDs_rogues;        
            allUtility["|cFFB4B4B4"] = TehrsCDs._utilityCDs_nightelf;           
            
            for theCDGroupColor, theCDGroup in pairs(allUtility) do
                if (theCDGroup ~= nil) then        
                    for name, cdData in pairs(theCDGroup) do             
                        for cdName, cdTime in aura_env.sortedPairs(cdData) do 
                            
                            if not ((not TehrsCDs["Show Settings"].Hope and cdName == "Hope")
                                or (not TehrsCDs["Show Settings"].Grip and cdName == "Grip")
                                or (not TehrsCDs["Show Settings"].Innervate and cdName == "Innervate")
                                or (not TehrsCDs["Show Settings"].Treants and cdName == "Treants")                                
                                or (not TehrsCDs["Show Settings"].Roar and cdName == "Roar")
                                or (not TehrsCDs["Show Settings"].BoP and cdName == "BoP")
                                or (not TehrsCDs["Show Settings"].WindRush and cdName == "Wind Rush")
                                or (not TehrsCDs["Show Settings"].Misdirect and cdName == "Misdirect")
                                or (not TehrsCDs["Show Settings"].Shadowmeld and cdName == "Shadowmeld")
                                or (not TehrsCDs["Show Settings"].Shroud and cdName == "Shroud")
                                or (not TehrsCDs["Show Settings"].Tricks and cdName == "Tricks")) then                         
                                
                                local timeColor;
                                local nameColor;
                                local cdDTime = cdTime - GetTime();   
                                local unitName = UnitName(name)                            
                                local unitRealm = GetRealmName(name)                                
                                
                                if aura_env.recolor then
                                    if (UnitHealth(name) <= 0 or UnitIsGhost(name)) then
                                        nameColor = aura_env.deadColor
                                        timeColor = aura_env.deadColor
                                    elseif not IsItemInRange(34471,name) and 
                                        (cdName == "Grip" or cdName == "Innervate" or cdName == "BoP" or cdName == "Misdirect" or cdName == "Tricks") then
                                        nameColor = aura_env.outOfRangeColor
                                        timeColor = aura_env.outOfRangeColor                                    
                                    else    
                                        nameColor = theCDGroupColor
                                        timeColor = aura_env.colorByTime(cdDTime)
                                    end      
                                else    
                                    nameColor = theCDGroupColor
                                    timeColor = aura_env.colorByTime(cdDTime)                   
                                end    
                                
                                if (cdDTime <= 0) then
                                    cdDTime = timeColor.."READY|r";
                                else
                                    cdDTime = timeColor..string.format("%01d:%02d", math.floor(cdDTime/60), math.floor(cdDTime - 60*math.floor(cdDTime/60))).."|r"
                                end            
                                
                                dashpos = string.find(name,"-");
                                if (dashpos ~= nil) then name = string.sub(name, 0, dashpos - 1) end
                                
                                newName = string.sub(name, 0, nameMaxLength);
                                
                                if (string.len(newName) <  string.len(name)) then newName = newName..".." end
                                
                                for k,v in pairs(aura_env.Supporters) do
                                    if (k == name) and (v == unitRealm) then
                                        newName = "*"..newName
                                    end
                                end
                                
                                if abilityNames ~= nil then
                                    for k,v in pairs(abilityNames) do
                                        if k == cdName then
                                            cdName = v
                                        end    
                                    end    
                                end
                                
                                if newName ~= nil then
                                    if not TehrsCDs["Show Settings"].ShowOnCooldownOnly or (TehrsCDs["Show Settings"].ShowOnCooldownOnly and cdDTime ~= timeColor.."READY|r") then
                                        cdCount = cdCount + 1 
                                        cdTexts[cdCount] = {
                                            aura_env.raidCDsIndentAmount..nameColor..newName,
                                            nameColor..cdName,
                                            cdDTime
                                        }
                                    end
                                end                                
                            end
                        end           
                    end        
                end    
            end
            if TehrsCDs["Show Settings"].ShowEmptySections or #cdTexts > 0 then
                TehrsCDs._raidCDs_namesText =  TehrsCDs._raidCDs_namesText.."\n|cFF00A2E8"..titles[3].."               |r\n\n";
                TehrsCDs._raidCDs_cdText = TehrsCDs._raidCDs_cdText.."\n\n\n";
                TehrsCDs._raidCDs_timeText = TehrsCDs._raidCDs_timeText.."\n\n\n"; 

                if #cdTexts > 0 then 
                    for index, value in pairs(cdTexts) do
                        TehrsCDs._raidCDs_namesText =  TehrsCDs._raidCDs_namesText..value[1].."\n";
                        TehrsCDs._raidCDs_cdText = TehrsCDs._raidCDs_cdText..value[2].."\n";
                        TehrsCDs._raidCDs_timeText = TehrsCDs._raidCDs_timeText..value[3].."\n";  
                    end
                end
            end            
        end  
        
        if (TehrsCDs["Show Settings"].allImmunityCDs and TehrsCDs.instanceType ~= "raid" and GetNumGroupMembers()<20) or (TehrsCDs["Show Settings"].allImmunityCDs_inRaid and (TehrsCDs.instanceType == "raid" or GetNumGroupMembers()>19)) then                
            
            local cdCount = 0;
            local cdTexts = { }; 
            local allImmunities = { };
            
            allImmunities["|cFFABD473"] = TehrsCDs._immunityCDs_hunters;
            allImmunities["|cFF69CCF0"] = TehrsCDs._immunityCDs_mages;
            allImmunities["|cFFF58CBA"] = TehrsCDs._immunityCDs_paladins;         
            allImmunities["|cFFFFF569"] = TehrsCDs._immunityCDs_rogues;
            allImmunities["|cFFA330C9"] = TehrsCDs._immunityCDs_dhs;    
            
            for theCDGroupColor, theCDGroup in pairs(allImmunities) do
                if (theCDGroup ~= nil) then        
                    for name, cdData in pairs(theCDGroup) do             
                        for cdName, cdTime in aura_env.sortedPairs(cdData) do 
                            
                            if not ((not TehrsCDs["Show Settings"].Netherwalk and cdName == "Netherwalk")
                                or (not TehrsCDs["Show Settings"].Bubble and cdName == "Bubble")
                                or (not TehrsCDs["Show Settings"].Bubble and cdName == "Bubble+")
                                or (not TehrsCDs["Show Settings"].Turtle and cdName == "Turtle")
                                or (not TehrsCDs["Show Settings"].Turtle and cdName == "Turtle+")
                                or (not TehrsCDs["Show Settings"].Cloak and cdName == "Cloak")
                                or (not TehrsCDs["Show Settings"].Block and cdName == "Block")
                                or (not TehrsCDs["Show Settings"].Block and cdName == "Block+")) then                            
                                
                                local timeColor;
                                local nameColor;
                                local cdDTime = cdTime - GetTime();  
                                local unitName = UnitName(name)                            
                                local unitRealm = GetRealmName(name)                                
                                
                                if aura_env.recolor then
                                    if (UnitHealth(name) <= 0 or UnitIsGhost(name)) then
                                        nameColor = aura_env.deadColor
                                        timeColor = aura_env.deadColor                                    
                                    else    
                                        nameColor = theCDGroupColor
                                        timeColor = aura_env.colorByTime(cdDTime)
                                    end      
                                else    
                                    nameColor = theCDGroupColor
                                    timeColor = aura_env.colorByTime(cdDTime)                   
                                end    
                                
                                if (cdDTime <= 0) then
                                    cdDTime = timeColor.."READY|r";
                                else
                                    cdDTime = timeColor..string.format("%01d:%02d", math.floor(cdDTime/60), math.floor(cdDTime - 60*math.floor(cdDTime/60))).."|r"
                                end            
                                
                                dashpos = string.find(name,"-");
                                if (dashpos ~= nil) then name = string.sub(name, 0, dashpos - 1) end
                                
                                newName = string.sub(name, 0, nameMaxLength);
                                
                                if (string.len(newName) <  string.len(name)) then newName = newName..".." end
                                
                                for k,v in pairs(aura_env.Supporters) do
                                    if (k == name) and (v == unitRealm) then
                                        newName = "*"..newName
                                    end
                                end
                                
                                if abilityNames ~= nil then
                                    for k,v in pairs(abilityNames) do
                                        if k == cdName then
                                            cdName = v
                                        end    
                                    end    
                                end
                                
                                if newName ~= nil then
                                    if not TehrsCDs["Show Settings"].ShowOnCooldownOnly or (TehrsCDs["Show Settings"].ShowOnCooldownOnly and cdDTime ~= timeColor.."READY|r") then
                                        cdCount = cdCount + 1 
                                        cdTexts[cdCount] = {
                                            aura_env.raidCDsIndentAmount..nameColor..newName,
                                            nameColor..cdName,
                                            cdDTime
                                        }
                                    end
                                end                                
                            end
                        end           
                    end        
                end    
            end
            if TehrsCDs["Show Settings"].ShowEmptySections or #cdTexts > 0 then
                TehrsCDs._raidCDs_namesText =  TehrsCDs._raidCDs_namesText.."\n|cFF00A2E8"..titles[4].."               |r\n\n";
                TehrsCDs._raidCDs_cdText = TehrsCDs._raidCDs_cdText.."\n\n\n";
                TehrsCDs._raidCDs_timeText = TehrsCDs._raidCDs_timeText.."\n\n\n"; 

                if #cdTexts > 0 then 
                    for index, value in pairs(cdTexts) do
                        TehrsCDs._raidCDs_namesText =  TehrsCDs._raidCDs_namesText..value[1].."\n";
                        TehrsCDs._raidCDs_cdText = TehrsCDs._raidCDs_cdText..value[2].."\n";
                        TehrsCDs._raidCDs_timeText = TehrsCDs._raidCDs_timeText..value[3].."\n";  
                    end
                end
            end            
        end         
        
        if (TehrsCDs["Show Settings"].allAoECCs and TehrsCDs.instanceType ~= "raid" and GetNumGroupMembers()<20) or (TehrsCDs["Show Settings"].allAoECCs_inRaid and (TehrsCDs.instanceType == "raid" or GetNumGroupMembers()>19)) then        
            
            local cdCount = 0;
            local cdTexts = { }; 
            local allCDs = { };
            
            allCDs["|cFFFF7D0A"] = TehrsCDs._aoeCCs_druids;
            allCDs["|cFFFFFFFF"] = TehrsCDs._aoeCCs_priests;        
            allCDs["|cFFABD473"] = TehrsCDs._aoeCCs_hunters;
            allCDs["|cFF69CCF0"] = TehrsCDs._aoeCCs_mages;
            allCDs["|cFF00FF96"] = TehrsCDs._aoeCCs_monks;      
            allCDs["|cFF0070DE"] = TehrsCDs._aoeCCs_shamans;       
            allCDs["|cFFC79C6E"] = TehrsCDs._aoeCCs_warriors;  
            allCDs["|cFFA330C9"] = TehrsCDs._aoeCCs_dhs;                     
            allCDs["|cFF9482C9"] = TehrsCDs._aoeCCs_warlocks; 
            allCDs["|cFFC41F3B"] = TehrsCDs._aoeCCs_dks;                 
            allCDs["|cFFB4B4B4"] = TehrsCDs._aoeCCs_tauren;      
            allCDs["|cFFB4B4B4"] = TehrsCDs._aoeCCs_hmtauren;            
            
            for theCDGroupColor, theCDGroup in pairs(allCDs) do
                if (theCDGroup ~= nil) then        
                    for name, cdData in pairs(theCDGroup) do             
                        for cdName, cdTime in aura_env.sortedPairs(cdData) do 
                            
                            if not ((not TehrsCDs["Show Settings"].Stomp and cdName == "Stomp")
                                or (not TehrsCDs["Show Settings"].BullRush and cdName == "Bull Rush")
                                or (not TehrsCDs["Show Settings"].Ursol and cdName == "Ursol")
                                or (not TehrsCDs["Show Settings"].Typhoon and cdName == "Typhoon")
                                or (not TehrsCDs["Show Settings"].MindBomb and cdName == "Mind Bomb")
                                or (not TehrsCDs["Show Settings"].Shockwave and cdName == "Shockwave")
                                or (not TehrsCDs["Show Settings"].Shockwave and cdName == "Shockwave+")
                                or (not TehrsCDs["Show Settings"].Chains and cdName == "Chains")
                                or (not TehrsCDs["Show Settings"].Grasp and cdName == "Grasp")
                                or (not TehrsCDs["Show Settings"].Grasp and cdName == "Grasp+")
                                or (not TehrsCDs["Show Settings"].CapTotem and cdName == "Cap Totem")
                                or (not TehrsCDs["Show Settings"].CapTotem and cdName == "Cap Totem+")
                                or (not TehrsCDs["Show Settings"].Binding and cdName == "Binding")
                                or (not TehrsCDs["Show Settings"].Infernal and cdName == "Infernal")
                                or (not TehrsCDs["Show Settings"].Thunderstorm and cdName == "Thunderstorm")
                                or (not TehrsCDs["Show Settings"].Ring and cdName == "Ring")
                                or (not TehrsCDs["Show Settings"].Shining and cdName == "Shining")                                
                                or (not TehrsCDs["Show Settings"].Shadowfury and cdName == "Shadowfury+")
                                or (not TehrsCDs["Show Settings"].Shadowfury and cdName == "Shadowfury")
                                or (not TehrsCDs["Show Settings"].Sweep and cdName == "Sweep")
                                or (not TehrsCDs["Show Settings"].Sweep and cdName == "Sweep+")
                                or (not TehrsCDs["Show Settings"].Nova and cdName == "Nova")
                                or (not TehrsCDs["Show Settings"].Nova and cdName == "Nova+")) then                                 
                                
                                local timeColor;
                                local nameColor;
                                local cdDTime = cdTime - GetTime(); 
                                local unitName = UnitName(name)                            
                                local unitRealm = GetRealmName(name)                                
                                
                                if aura_env.recolor then
                                    if (UnitHealth(name) <= 0 or UnitIsGhost(name)) then
                                        nameColor = aura_env.deadColor
                                        timeColor = aura_env.deadColor                                    
                                    else    
                                        nameColor = theCDGroupColor
                                        timeColor = aura_env.colorByTime(cdDTime)
                                    end      
                                else    
                                    nameColor = theCDGroupColor
                                    timeColor = aura_env.colorByTime(cdDTime)                   
                                end    
                                
                                if (cdDTime <= 0) then
                                    cdDTime = timeColor.."READY|r";
                                else
                                    cdDTime = timeColor..string.format("%01d:%02d", math.floor(cdDTime/60), math.floor(cdDTime - 60*math.floor(cdDTime/60))).."|r"
                                end            
                                
                                dashpos = string.find(name,"-");
                                if (dashpos ~= nil) then name = string.sub(name, 0, dashpos - 1) end
                                
                                newName = string.sub(name, 0, nameMaxLength);
                                
                                if (string.len(newName) <  string.len(name)) then newName = newName..".." end
                                
                                for k,v in pairs(aura_env.Supporters) do
                                    if (k == name) and (v == unitRealm) then
                                        newName = "*"..newName
                                    end
                                end
                                
                                if abilityNames ~= nil then
                                    for k,v in pairs(abilityNames) do
                                        if k == cdName then
                                            cdName = v
                                        end    
                                    end    
                                end
                                
                                if newName ~= nil then
                                    if not TehrsCDs["Show Settings"].ShowOnCooldownOnly or (TehrsCDs["Show Settings"].ShowOnCooldownOnly and cdDTime ~= timeColor.."READY|r") then
                                        cdCount = cdCount + 1 
                                        cdTexts[cdCount] = {
                                            aura_env.raidCDsIndentAmount..nameColor..newName,
                                            nameColor..cdName,
                                            cdDTime
                                        }
                                    end
                                end                                
                            end
                        end           
                    end        
                end    
            end
            if TehrsCDs["Show Settings"].ShowEmptySections or #cdTexts > 0 then
                TehrsCDs._raidCDs_namesText =  TehrsCDs._raidCDs_namesText.."\n|cFF00A2E8"..titles[5].."               |r\n\n";
                TehrsCDs._raidCDs_cdText = TehrsCDs._raidCDs_cdText.."\n\n\n";
                TehrsCDs._raidCDs_timeText = TehrsCDs._raidCDs_timeText.."\n\n\n"; 

                if #cdTexts > 0 then 
                    for index, value in pairs(cdTexts) do
                        TehrsCDs._raidCDs_namesText =  TehrsCDs._raidCDs_namesText..value[1].."\n";
                        TehrsCDs._raidCDs_cdText = TehrsCDs._raidCDs_cdText..value[2].."\n";
                        TehrsCDs._raidCDs_timeText = TehrsCDs._raidCDs_timeText..value[3].."\n";  
                    end
                end
            end            
        end    
        
        if (TehrsCDs["Show Settings"].allInterrupts and TehrsCDs.instanceType ~= "raid" and GetNumGroupMembers()<20) or (TehrsCDs["Show Settings"].allInterrupts_inRaid and (TehrsCDs.instanceType == "raid" or GetNumGroupMembers()>19)) then
            
            local cdCount = 0;
            local cdTexts = { }; 
            local allinterrupts = { };
            
            allinterrupts["|cFFFF7D0A"] = TehrsCDs._interrupts_druids;
            allinterrupts["|cFFFFFFFF"] = TehrsCDs._interrupts_priests;        
            allinterrupts["|cFFABD473"] = TehrsCDs._interrupts_hunters;
            allinterrupts["|cFF69CCF0"] = TehrsCDs._interrupts_mages;
            allinterrupts["|cFF00FF96"] = TehrsCDs._interrupts_monks;
            allinterrupts["|cFFF58CBA"] = TehrsCDs._interrupts_paladins;        
            allinterrupts["|cFF0070DE"] = TehrsCDs._interrupts_shamans;        
            allinterrupts["|cFFC41F3B"] = TehrsCDs._interrupts_dks;         
            allinterrupts["|cFFFFF569"] = TehrsCDs._interrupts_rogues;
            allinterrupts["|cFFC79C6E"] = TehrsCDs._interrupts_warriors;
            allinterrupts["|cFFA330C9"] = TehrsCDs._interrupts_dhs;
            allinterrupts["|cFF9482C9"] = TehrsCDs._interrupts_warlocks;      
            allinterrupts["|cFFB4B4B4"] = TehrsCDs._interrupts_belfs;         
            
            for theCDGroupColor, theCDGroup in pairs(allinterrupts) do
                if (theCDGroup ~= nil) then        
                    for name, cdData in pairs(theCDGroup) do             
                        for cdName, cdTime in aura_env.sortedPairs(cdData) do 
                            
                            if not( (not TehrsCDs["Show Settings"].Pummel and cdName == "Pummel")
                                --[[ or (not TehrsCDs["Show Settings"].Torrent and cdName == "Torrent")
                                Arcane Torrent isn't an interrupt anymore! Holding onto this until I add dispels.
                                ]]
                                or (not TehrsCDs["Show Settings"].Silence and cdName == "Silence")
                                or (not TehrsCDs["Show Settings"].Silence and cdName == "Silence+")
                                or (not TehrsCDs["Show Settings"].Disrupt and cdName == "Disrupt")
                                or (not TehrsCDs["Show Settings"].SigilSilence and cdName == "S-Silence")
                                or (not TehrsCDs["Show Settings"].SigilSilence and cdName == "S-Silence+")
                                or (not TehrsCDs["Show Settings"].SBash and cdName == "S-Bash")
                                or (not TehrsCDs["Show Settings"].SBeam and cdName == "S-Beam")
                                or (not TehrsCDs["Show Settings"].MindFreeze and cdName == "M-Freeze")
                                or (not TehrsCDs["Show Settings"].Rebuke and cdName == "Rebuke")
                                or (not TehrsCDs["Show Settings"].WShear and cdName == "W-Shear")
                                or (not TehrsCDs["Show Settings"].Muzzle and cdName == "Muzzle")
                                or (not TehrsCDs["Show Settings"].CShot and cdName == "C-Shot")
                                or (not TehrsCDs["Show Settings"].Kick and cdName == "Kick")
                                or (not TehrsCDs["Show Settings"].CSpell and cdName == "C-Spell")
                                or (not TehrsCDs["Show Settings"].SpellLock and cdName == "Spell Lock")
                                or (not TehrsCDs["Show Settings"].SStrike and cdName == "S-Strike")) then                        
                                
                                local timeColor;
                                local nameColor;
                                local cdDTime = cdTime - GetTime(); 
                                local unitName = UnitName(name)                            
                                local unitRealm = GetRealmName(name)                                
                                
                                if aura_env.recolor then
                                    if (UnitHealth(name) <= 0 or UnitIsGhost(name)) then
                                        nameColor = aura_env.deadColor
                                        timeColor = aura_env.deadColor                                    
                                    else    
                                        nameColor = theCDGroupColor
                                        timeColor = aura_env.colorByTime(cdDTime)                    
                                    end      
                                else    
                                    nameColor = theCDGroupColor
                                    timeColor = aura_env.colorByTime(cdDTime)                   
                                end     
              
                                if (cdDTime <= 0) then
                                    cdDTime = timeColor.."READY|r";
                                else
                                    cdDTime = timeColor..math.floor(cdDTime).."|r";
                                end            
                                
                                dashpos = string.find(name,"-");
                                if (dashpos ~= nil) then name = string.sub(name, 0, dashpos - 1) end
                                
                                newName = string.sub(name, 0, nameMaxLength);
                                
                                if (string.len(newName) <  string.len(name)) then newName = newName..".." end
                                
                                for k,v in pairs(aura_env.Supporters) do
                                    if (k == name) and (v == unitRealm) then
                                        newName = "*"..newName
                                    end
                                end
                                
                                if abilityNames ~= nil then
                                    for k,v in pairs(abilityNames) do
                                        if k == cdName then
                                            cdName = v
                                        end    
                                    end    
                                end
                                
                                if newName ~= nil then
                                    if not TehrsCDs["Show Settings"].ShowOnCooldownOnly or (TehrsCDs["Show Settings"].ShowOnCooldownOnly and cdDTime ~= timeColor.."READY|r") then
                                        cdCount = cdCount + 1 
                                        cdTexts[cdCount] = {
                                            aura_env.raidCDsIndentAmount..nameColor..newName,
                                            nameColor..cdName,
                                            cdDTime
                                        }
                                    end
                                end    
                            end
                        end           
                    end        
                end    
            end
            if TehrsCDs["Show Settings"].ShowEmptySections or #cdTexts > 0 then
                TehrsCDs._raidCDs_namesText =  TehrsCDs._raidCDs_namesText.."\n|cFF00A2E8"..titles[6].."               |r\n\n";
                TehrsCDs._raidCDs_cdText = TehrsCDs._raidCDs_cdText.."\n\n\n";
                TehrsCDs._raidCDs_timeText = TehrsCDs._raidCDs_timeText.."\n\n\n"; 

                if #cdTexts > 0 then 
                    for index, value in pairs(cdTexts) do
                        TehrsCDs._raidCDs_namesText =  TehrsCDs._raidCDs_namesText..value[1].."\n";
                        TehrsCDs._raidCDs_cdText = TehrsCDs._raidCDs_cdText..value[2].."\n";
                        TehrsCDs._raidCDs_timeText = TehrsCDs._raidCDs_timeText..value[3].."\n";  
                    end
                end
            end
        end
        
        if (TehrsCDs["Show Settings"].allRezzes and TehrsCDs.instanceType ~= "raid" and GetNumGroupMembers()<20) or ((TehrsCDs["Show Settings"].allRezzes_inRaid or TehrsCDs["Show Settings"].Ankh_inRaid or TehrsCDs["Show Settings"].raidBattleRezTimer) and (TehrsCDs.instanceType == "raid" or GetNumGroupMembers()>19)) then
            
            local cdCount = 0;
            local cdTexts = { }; 
            local allRezzes = { };
            local rezType = titles[7]
            
            if (TehrsCDs.instanceDifficulty ~= 8) and ((TehrsCDs["Show Settings"].allRezzes and TehrsCDs.instanceType ~= "raid" and GetNumGroupMembers()<20) or (not TehrsCDs.encounterStart and TehrsCDs["Show Settings"].allRezzes_inRaid and (TehrsCDs.instanceType == "raid" or GetNumGroupMembers()>19))) then    
                allRezzes["|cFFC41F3B"] = TehrsCDs._rezCDs_dks;      
                allRezzes["|cFFFF7D0A"] = TehrsCDs._rezCDs_druids; 
                allRezzes["|cFF9482C9"] = TehrsCDs._rezCDs_warlocks;
                allRezzes["|cFF0070DE"] = TehrsCDs._rezCDs_shamans; 
            elseif (TehrsCDs["Show Settings"].Ankh_inRaid) then
                allRezzes["|cFF0070DE"] = TehrsCDs._rezCDs_shamans; 
            else
                rezType = titles[8]
            end
            
            for theCDGroupColor, theCDGroup in pairs(allRezzes) do
                if (theCDGroup ~= nil) then        
                    for name, cdData in pairs(theCDGroup) do             
                        for cdName, cdTime in aura_env.sortedPairs(cdData) do 
                            
                            if not ((not TehrsCDs["Show Settings"].Rebirth and cdName == "Rebirth")
                                or (not TehrsCDs["Show Settings"].RaiseAlly and cdName == "Raise Ally")
                                or (not TehrsCDs["Show Settings"].Ankh and cdName == "Ankh")
                                or (not TehrsCDs["Show Settings"].Soulstone and cdName == "Soulstone")) then 
                                
                                local timeColor;
                                local nameColor;
                                local cdDTime = cdTime - GetTime();
                                local unitName = UnitName(name)                            
                                local unitRealm = GetRealmName(name)
                                
                                if aura_env.recolor then
                                    if (UnitHealth(name) <= 0 or UnitIsGhost(name)) then
                                        nameColor = aura_env.deadColor
                                        timeColor = aura_env.deadColor                                    
                                    else    
                                        nameColor = theCDGroupColor
                                        timeColor = aura_env.colorByTime(cdDTime)                    
                                    end      
                                else    
                                    nameColor = theCDGroupColor
                                    timeColor = aura_env.colorByTime(cdDTime)                   
                                end 
                                            
                                if (cdDTime <= 0) then
                                    cdDTime = timeColor.."READY|r";
                                else
                                    cdDTime = timeColor..string.format("%01d:%02d", math.floor(cdDTime/60), math.floor(cdDTime - 60*math.floor(cdDTime/60))).."|r"
                                end                     
                                
                                dashpos = string.find(name,"-");
                                if (dashpos ~= nil) then name = string.sub(name, 0, dashpos - 1) end
                                
                                newName = string.sub(name, 0, nameMaxLength);
                                
                                if (string.len(newName) <  string.len(name)) then newName = newName..".." end
                                
                                for k,v in pairs(aura_env.Supporters) do
                                    if (k == name) and (v == unitRealm) then
                                        newName = "*"..newName
                                    end
                                end
                                
                                if abilityNames ~= nil then
                                    for k,v in pairs(abilityNames) do
                                        if k == cdName then
                                            cdName = v
                                        end    
                                    end    
                                end
                                
                                if newName ~= nil then
                                    if not TehrsCDs["Show Settings"].ShowOnCooldownOnly or (TehrsCDs["Show Settings"].ShowOnCooldownOnly and cdDTime ~= timeColor.."READY|r") then
                                        cdCount = cdCount + 1 
                                        cdTexts[cdCount] = {
                                            aura_env.raidCDsIndentAmount..nameColor..newName,
                                            nameColor..cdName,
                                            cdDTime
                                        }
                                    end
                                end    
                            end
                        end           
                    end        
                end    
            end
            
            if TehrsCDs["Show Settings"].ShowEmptySections or #cdTexts > 0 then
                TehrsCDs._raidCDs_namesText =  TehrsCDs._raidCDs_namesText.."\n|cFF00A2E8"..rezType.."               |r\n\n";
                TehrsCDs._raidCDs_cdText = TehrsCDs._raidCDs_cdText.."\n\n\n";
                TehrsCDs._raidCDs_timeText = TehrsCDs._raidCDs_timeText.."\n\n\n"; 

                if #cdTexts > 0 then 
                    for index, value in pairs(cdTexts) do
                        TehrsCDs._raidCDs_namesText =  TehrsCDs._raidCDs_namesText..value[1].."\n";
                        TehrsCDs._raidCDs_cdText = TehrsCDs._raidCDs_cdText..value[2].."\n";
                        TehrsCDs._raidCDs_timeText = TehrsCDs._raidCDs_timeText..value[3].."\n";  
                    end
                end
            end            
            
            if ((TehrsCDs["Show Settings"].mythicDungeonBattleRezTimer and TehrsCDs.instanceGroupType == "party" and TehrsCDs.instanceDifficulty == 8) or (TehrsCDs["Show Settings"].raidBattleRezTimer and TehrsCDs.instanceType == "raid")) and GetSpellCharges(20484) then   
                
                -- BIG THANKS to Krazyito for this code http://www.mmo-champion.com/threads/1686033-Weak-Auras-Battle-Res-Monitor-Looking-for-feedback     
                
                local rezCharges, _, started, duration = GetSpellCharges(20484)
                local timerString = ""            
                local extraSpace = ""
                
                if started then
                    local brezTimer = duration - (GetTime() - started)
                    local m = floor(brezTimer/60)
                    local s = mod(brezTimer, 60)
                    timerString =  string.format("%01d:%02d", m, s)
                end
                
                if rezCharges == nil then
                    rezCharges = 0
                end
                
                if rezCharges == 0 then
                    rezCharges = "|cFF333333"..rezCharges.."|r"
                else
                    rezCharges ="|cFF00FF00"..rezCharges.."|r" 
                end
                
				if TehrsCDs._rezCDs_shamans then
					extraSpace = "\n"
				end                
                
                TehrsCDs._raidCDs_namesText = TehrsCDs._raidCDs_namesText..extraSpace..aura_env.raidCDsIndentAmount.."|cFFFFFFFFCharges|r:\n"
                TehrsCDs._raidCDs_cdText = TehrsCDs._raidCDs_cdText..extraSpace..rezCharges.."\n";
                TehrsCDs._raidCDs_timeText = TehrsCDs._raidCDs_timeText..extraSpace..timerString.."\n";
            end        
        end          
    end
    
    local point, relativeTo, relativePoint, xOffset, yOffset = WeakAuras.regions[aura_env.id].region:GetPoint()
    if point == "TOPLEFT" then    
        TehrsCDs._raidCDs_namesText = TehrsCDs._raidCDs_namesText.."                                                          \n";
        TehrsCDs._raidCDs_cdText = TehrsCDs._raidCDs_cdText.."                                                             \n";
        TehrsCDs._raidCDs_timeText = TehrsCDs._raidCDs_timeText.."                                                             \n";    
    end
    
    if WeakAuras.regions[backgroundName] then
        _, TehrsCDs.NamesTextLineCount = string.gsub(TehrsCDs._raidCDs_namesText, "\n", "");
        local newWidth = 200 + (fontSize-11)*15
        local newHeight = TehrsCDs.NamesTextLineCount * fontSize
        
        WeakAuras.regions[backgroundName].region:SetHeight(newHeight); 
        WeakAuras.regions[backgroundName].region:SetWidth(newWidth) 
        _,_,_,TehrsCDs.BackgroundAlpha = WeakAuras.regions[WeakAurasSaved.displays[WeakAuras.regions[aura_env.id].region:GetParent().id]["controlledChildren"][6]].region.texture:GetVertexColor()
        
    end
    return TehrsCDs._raidCDs_namesText     
end
